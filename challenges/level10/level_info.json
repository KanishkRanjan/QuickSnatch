{
    "level": 10,
    "title": "Final Challenge",
    "description": "The ultimate test of your Linux skills. Combine everything you've learned to find the final flag.",
    "prompt": "hackerpro@quicksnatch",
    "difficulty": "Expert",
    "flag": "flag{linux_master_2025_final}",
    "files": {
        "/home/user/final/encrypted.bin": "Binary encrypted content",
        "/home/user/final/decrypt.sh": "#!/bin/bash\n# Decryption script\n# Usage: ./decrypt.sh <key>\n\nKEY=$1\nif [ -z \"$KEY\" ]; then\n    echo \"Error: Key required\"\n    exit 1\nfi\n\n# The key is hidden in the process environment\n# Check running processes and their environment variables\n# Also check system services and cron jobs\n# The key format is: YYYY-MM-DD-LEVEL\n\nopenssl enc -d -aes-256-cbc -in encrypted.bin -out decrypted.txt -k \"$KEY\"",
        "/etc/systemd/system/key-service.service": "[Unit]\nDescription=Key Management Service\n\n[Service]\nType=simple\nEnvironment=KEY_DATE=2025-01-17\nEnvironment=KEY_LEVEL=10\nExecStart=/usr/local/bin/key-service\n\n[Install]\nWantedBy=multi-user.target",
        "/var/spool/cron/crontabs/root": "# DO NOT EDIT THIS FILE - edit the master and reinstall.\n# (/tmp/crontab.XXXXqPqZVx installed on Thu Jan 17 14:30:00 2025)\n# (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)\n0 * * * * /usr/local/bin/key-rotator.sh",
        "/var/log/auth.log": "Jan 17 14:30:00 quicksnatch sshd[1234]: Accepted password for root\nJan 17 14:30:01 quicksnatch sudo: hackerpro : TTY=pts/0 ; PWD=/home/user ; USER=root ; COMMAND=/usr/bin/cat /etc/shadow",
        "/home/user/final/README.txt": "Final Challenge\n\n1. Find the encryption key\n   - Check system services\n   - Monitor processes\n   - Analyze cron jobs\n   - Key format: YYYY-MM-DD-LEVEL\n\n2. Decrypt the file\n   - Use decrypt.sh with the correct key\n   - The decrypted file contains the flag\n\nCombine all your knowledge from previous levels:\n- File permissions\n- Process inspection\n- Service configuration\n- Cron jobs\n- Log analysis\n\nGood luck!"
    },
    "hints": [
        "The key combines information from services and cron jobs",
        "Check environment variables in the key service",
        "The date and level number are important",
        "Use the decrypt script once you have the key"
    ],
    "commands": [
        "ls",
        "cd",
        "pwd",
        "cat",
        "ps",
        "grep",
        "systemctl",
        "crontab",
        "openssl",
        "chmod",
        "bash"
    ]
}
